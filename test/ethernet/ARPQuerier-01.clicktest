%script
click --simtime CONFIG 2> PRINT
sort < TABLE | sed 's/:/-/g' > SORTEDTABLE
click --simtime CONFIG2 2> PRINT2
sort < TABLE | sed 's/:/-/g' > SORTEDTABLE2

%file CONFIG
FromIPSummaryDump(IN, STOP true)
	-> arpq::ARPQuerier(1.0.0.1/24, 2:1:1:1:1:1)
	-> Print(MAXLENGTH 32) -> Discard;
arpq[1] -> ARPResponder(2.0/16 2:1:1:1:1:0, 2.1/16 2:1:1:1:1:1,
	   	2.2/16 2:1:1:1:1:2, 2.3/16 2:1:1:1:1:3,
	   	2.4/16 2:1:1:1:1:4, 2.5/16 2:1:1:1:1:5,
	   	2.6/16 2:1:1:1:1:6, 2.7/16 2:1:1:1:1:7,
	   	2.8/16 2:1:1:1:1:8, 2.9/16 2:1:1:1:1:9,
	   	2.10/16 2:1:1:1:1:A, 2.11/16 2:1:1:1:1:B,
	   	2.12/16 2:1:1:1:1:C, 2.13/16 2:1:1:1:1:D)
	-> [1]arpq;

DriverManager(pause, print >TABLE arpq.table)

%file CONFIG2
FromIPSummaryDump(IN, STOP true)
	-> arpq::ARPQuerier(1.0.0.1/24, 2:1:1:1:1:1, CAPACITY 10)
	-> Print(MAXLENGTH 32) -> Discard;
arpq[1] -> SetTimestamp -> Queue -> DelayUnqueue(.1s)
	-> ARPResponder(2.0/16 2:1:1:1:1:0, 2.1/16 2:1:1:1:1:1,
	   	2.2/16 2:1:1:1:1:2, 2.3/16 2:1:1:1:1:3,
	   	2.4/16 2:1:1:1:1:4, 2.5/16 2:1:1:1:1:5,
	   	2.6/16 2:1:1:1:1:6, 2.7/16 2:1:1:1:1:7,
	   	2.8/16 2:1:1:1:1:8, 2.9/16 2:1:1:1:1:9,
	   	2.10/16 2:1:1:1:1:A, 2.11/16 2:1:1:1:1:B,
	   	2.12/16 2:1:1:1:1:C, 2.13/16 2:1:1:1:1:D)
	-> [1]arpq;

DriverManager(pause, wait .2s, print >TABLE arpq.table)

%file IN
!data ip_dst
2.0.0.1
2.1.0.1
2.2.0.1
2.3.0.1
2.4.0.1
2.5.0.1
2.6.0.1
2.7.0.1
2.8.0.1
2.9.0.1
2.10.0.1
2.11.0.1
2.12.0.1
2.13.0.1
2.0.0.1
2.1.0.1
2.2.0.1
2.3.0.1
2.4.0.1
2.5.0.1
2.6.0.1
2.7.0.1
2.8.0.1
2.9.0.1
2.10.0.1
2.11.0.1
2.12.0.1
2.13.0.1
1.0.0.255

%file TABLE

%expect SORTEDTABLE SORTEDTABLE2
2.0.0.1 1 02-01-01-01-01-00{{.*}}
2.1.0.1 1 02-01-01-01-01-01{{.*}}
2.10.0.1 1 02-01-01-01-01-0A{{.*}}
2.11.0.1 1 02-01-01-01-01-0B{{.*}}
2.12.0.1 1 02-01-01-01-01-0C{{.*}}
2.13.0.1 1 02-01-01-01-01-0D{{.*}}
2.2.0.1 1 02-01-01-01-01-02{{.*}}
2.3.0.1 1 02-01-01-01-01-03{{.*}}
2.4.0.1 1 02-01-01-01-01-04{{.*}}
2.5.0.1 1 02-01-01-01-01-05{{.*}}
2.6.0.1 1 02-01-01-01-01-06{{.*}}
2.7.0.1 1 02-01-01-01-01-07{{.*}}
2.8.0.1 1 02-01-01-01-01-08{{.*}}
2.9.0.1 1 02-01-01-01-01-09{{.*}}

%ignorex PRINT PRINT2
expensive.*

%expect PRINT
  54 | 02010101 01000201 01010101 08004500 00280000 00006406 00000000 00000200
  54 | 02010101 01010201 01010101 08004500 00280000 00006406 00000000 00000201
  54 | 02010101 01020201 01010101 08004500 00280000 00006406 00000000 00000202
  54 | 02010101 01030201 01010101 08004500 00280000 00006406 00000000 00000203
  54 | 02010101 01040201 01010101 08004500 00280000 00006406 00000000 00000204
  54 | 02010101 01050201 01010101 08004500 00280000 00006406 00000000 00000205
  54 | 02010101 01060201 01010101 08004500 00280000 00006406 00000000 00000206
  54 | 02010101 01070201 01010101 08004500 00280000 00006406 00000000 00000207
  54 | 02010101 01080201 01010101 08004500 00280000 00006406 00000000 00000208
  54 | 02010101 01090201 01010101 08004500 00280000 00006406 00000000 00000209
  54 | 02010101 010a0201 01010101 08004500 00280000 00006406 00000000 0000020a
  54 | 02010101 010b0201 01010101 08004500 00280000 00006406 00000000 0000020b
  54 | 02010101 010c0201 01010101 08004500 00280000 00006406 00000000 0000020c
  54 | 02010101 010d0201 01010101 08004500 00280000 00006406 00000000 0000020d
  54 | 02010101 01000201 01010101 08004500 00280000 00006406 00000000 00000200
  54 | 02010101 01010201 01010101 08004500 00280000 00006406 00000000 00000201
  54 | 02010101 01020201 01010101 08004500 00280000 00006406 00000000 00000202
  54 | 02010101 01030201 01010101 08004500 00280000 00006406 00000000 00000203
  54 | 02010101 01040201 01010101 08004500 00280000 00006406 00000000 00000204
  54 | 02010101 01050201 01010101 08004500 00280000 00006406 00000000 00000205
  54 | 02010101 01060201 01010101 08004500 00280000 00006406 00000000 00000206
  54 | 02010101 01070201 01010101 08004500 00280000 00006406 00000000 00000207
  54 | 02010101 01080201 01010101 08004500 00280000 00006406 00000000 00000208
  54 | 02010101 01090201 01010101 08004500 00280000 00006406 00000000 00000209
  54 | 02010101 010a0201 01010101 08004500 00280000 00006406 00000000 0000020a
  54 | 02010101 010b0201 01010101 08004500 00280000 00006406 00000000 0000020b
  54 | 02010101 010c0201 01010101 08004500 00280000 00006406 00000000 0000020c
  54 | 02010101 010d0201 01010101 08004500 00280000 00006406 00000000 0000020d
  54 | ffffffff ffff0201 01010101 08004500 00280000 00006406 00000000 00000100

%expect PRINT2
  54 | ffffffff ffff0201 01010101 08004500 00280000 00006406 00000000 00000100
  54 | 02010101 01080201 01010101 08004500 00280000 00006406 00000000 00000208
  54 | 02010101 01090201 01010101 08004500 00280000 00006406 00000000 00000209
  54 | 02010101 010a0201 01010101 08004500 00280000 00006406 00000000 0000020a
  54 | 02010101 010a0201 01010101 08004500 00280000 00006406 00000000 0000020a
  54 | 02010101 010b0201 01010101 08004500 00280000 00006406 00000000 0000020b
  54 | 02010101 010b0201 01010101 08004500 00280000 00006406 00000000 0000020b
  54 | 02010101 010c0201 01010101 08004500 00280000 00006406 00000000 0000020c
  54 | 02010101 010c0201 01010101 08004500 00280000 00006406 00000000 0000020c
  54 | 02010101 010d0201 01010101 08004500 00280000 00006406 00000000 0000020d
  54 | 02010101 010d0201 01010101 08004500 00280000 00006406 00000000 0000020d
